{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Try-me \n",
    "\n",
    "This notebooks demonstrates a few features of the PAVICS platform. We're using Birdy's WPSClient to call WPS processes directly from Python. To get the list of processes, simply type `fp.` then tab, and a drop down menu will pop-up showing the different processes that are available. To get information on the process and how to call it, simply type `help(fp.<name of process>)` or `fp.<name of process>?` followed by `CTRL-Enter`. In other words, the `WPSClient` exposes remote processes as if they were part of a normal python library. \n",
    "\n",
    "Note that his uses the bleeding edge version of owslib (github master) since some issues were found and fixed in the process of writing this notebook. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spatial and temporal subsetting \n",
    "\n",
    "A common task in climate data analysis is subsetting files over a region of interest. Global model simulations and observations cover the entire globe, while impact analyses are often concerned with a region. Instead of downloading the entire file on a local disk, it is often more practical to subset it on the server and only download the relevant part. \n",
    "\n",
    "This can be done through two ways: interactive analysis using OPeNDAP, or a WPS request for a subsetter. Let's start with the most direct approach with OPeNDAP. The PAVICS THREDDS server provides two links for each file, a link to the file itself which will download the file locally when accessed, and a *dodsC* link which supports the OPeNDAP protocol. We'll use this link and simply pass it to our netCDF library, here `xarray`. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.QuadMesh at 0x7f6d0d71e898>"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import xarray as xr\n",
    "import numpy as np\n",
    "from matplotlib import pyplot as plt\n",
    "# The dodsC link for the test file\n",
    "dap = 'https://pavics.ouranos.ca/twitcher/ows/proxy/thredds/dodsC/'\n",
    "ncfile = 'birdhouse/testdata/flyingpigeon/cmip5/tasmax_Amon_MPI-ESM-MR_rcp45_r1i1p1_200601-200612.nc'\n",
    "\n",
    "# Here we open the file and subset it using xarray fonctionality. \n",
    "ds = xr.open_dataset(dap+ncfile)\n",
    "tas = ds.tasmax\n",
    "subtas = tas.sel(time=slice('2006-01-01', '2006-03-01'), lon=slice(188,330), lat=slice(6, 70))\n",
    "subtas.isel(time=0).plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we're going to compute the min and max of the array and use this for the next example."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(239.8588409423828, 308.3053894042969)"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mn, mx = subtas.min().values.tolist(), subtas.max().values.tolist()\n",
    "mn, mx"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Gridded Data Renderer\n",
    "\n",
    "PAVICS uses ncWMS2 to render netCDF data on a map canvas. ncWMS2 use the OGC's WMS standard to serve images rendered from a netCDF file. The WMS `GetMap` operation specifies a layer (<netCDF file path>/<variable name>), styles, figure size and format, projection and color range and the server returns an image that can be displayed in a figure or a map canvas. \n",
    "   \n",
    "   \n",
    "Note that with the current configuration, the path for ncWMS layers starts with `outputs` and not `birdhouse` as in the THREDDS server. \n",
    "Note also that the image we obtain below is upside down compared to the one above. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<IPython.core.display.Image object>"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from owslib.wms import WebMapService\n",
    "from IPython.display import Image\n",
    "\n",
    "url = \"https://pavics.ouranos.ca/twitcher/ows/proxy/ncWMS2/wms\"\n",
    "wms = WebMapService(url, version='1.3.0')\n",
    "ncfile = 'outputs/testdata/flyingpigeon/cmip5/tasmax_Amon_MPI-ESM-MR_rcp45_r1i1p1_200601-200612.nc'\n",
    "resp = wms.getmap(\n",
    "          layers=[\"{}/{}\".format(ncfile, \"tasmax\")], \n",
    "          format='image/png', \n",
    "          colorscalerange='{},{}'.format(mn,mx), \n",
    "          size=[256,256], \n",
    "          srs='CRS:84', \n",
    "          bbox=(150, 30, 250, 80), \n",
    "          transparent=True)\n",
    "Image(resp.read())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Climate indices\n",
    "\n",
    "The current production version of PAVICS provides ICCLIM indices through the FlyingPigeon server, which includes over fourty different indices. In the example below, we're calling on the \n",
    "\n",
    "Another implementation of climate indices is in the works. It relies on the xarray+dask backend to parallelize computations in the background. The library of climate indices is [xclim](https://github.com/Ouranosinc/xclim) and the WPS server hosting it is [finch](https://github.com/bird-house/finch). "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "'Process' object is not iterable",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-62-3855d597c64f>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mbirdy\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mWPSClient\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0murl\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m'https://pavics.ouranos.ca/twitcher/ows/proxy/flyingpigeon/wps'\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mfp\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mWPSClient\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0murl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m~/src/birdy/birdy/client/base.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, url, processes, converters, username, password, headers, verify, cert, verbose, progress, version)\u001b[0m\n\u001b[1;32m     85\u001b[0m             \u001b[0;32mraise\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     86\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 87\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_processes\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_process_description\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mprocesses\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     88\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     89\u001b[0m         \u001b[0;31m# Build the methods\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/src/birdy/birdy/client/base.py\u001b[0m in \u001b[0;36m_get_process_description\u001b[0;34m(self, processes)\u001b[0m\n\u001b[1;32m    129\u001b[0m             \u001b[0mps\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_wps\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdescribeprocess\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpid\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mpid\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mprocess_names\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    130\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 131\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mOrderedDict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0midentifier\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mp\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mp\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mps\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    132\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    133\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_setup_logging\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mTypeError\u001b[0m: 'Process' object is not iterable"
     ]
    }
   ],
   "source": [
    "from birdy import WPSClient\n",
    "url = 'https://pavics.ouranos.ca/twitcher/ows/proxy/flyingpigeon/wps'\n",
    "fp = WPSClient(url)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "resp = fp.icclim_tx(resource=thredds+'cmip3/tas.sresb1.giss_model_e_r.run1.atm.da.nc', grouping='yr')\n",
    "tx, log = resp.get(as_obj=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Bias correction\n",
    "\n",
    "There is at the moment only one bias correction process implemented, the Kernel Density Distribution Mapping. It was written in R and given an observation variable `obs`, a simulated variable over the observation period `ref` and a future period `fut`, it would be called as `fp.kddm_bc(obs=obs, ref=ref, fut=fut)`. Since this function is so compute intensive, we'll create a small synthetic file for testing. \n",
    "\n",
    "### Note\n",
    "The current production version of FlyingPigeon runs on a version of PyWPS whose handling of binary files is sketchy. That means that it works well when files are provided as references, not embedded in an http request. This functionality will become available with the next update. For this example we'll use files stored on the PAVICS THREDDS server. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'fp' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-9-57f9d3c55267>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mfut\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mthredds\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;34m'tmax.fut.nc'\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m \u001b[0mresp\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkddm_bc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mobs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mref\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mref\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfut\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfut\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m \u001b[0mresp\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mNameError\u001b[0m: name 'fp' is not defined"
     ]
    }
   ],
   "source": [
    "thredds = 'https://pavics.ouranos.ca/twitcher/ows/proxy/thredds/fileServer/birdhouse/testdata/flyingpigeon/'\n",
    "          \n",
    "obs = thredds + 'tmax.obs.nc'\n",
    "ref = thredds + 'tmax.cur.nc'\n",
    "fut = thredds + 'tmax.fut.nc'\n",
    "\n",
    "resp = fp.kddm_bc(obs=obs, ref=ref, fut=fut)\n",
    "resp"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The response is a link to the bias-corrected file. It's possible to get the actual netCDF file by using the `get` method of the response. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "icclim_TXResponse(\n",
       "    output_netcdf='https://pavics.ouranos.ca:443/wpsoutputs/flyingpigeon/de46db5a-1441-11e9-888f-0242ac120014/de698fec-1441-11e9-888f-0242ac120014_TUFzax.nc',\n",
       "    output_log='https://pavics.ouranos.ca:443/wpsoutputs/flyingpigeon/de46db5a-1441-11e9-888f-0242ac120014/log_eyxZgY.txt'\n",
       ")"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tx"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Subset processes with WPS and FlyingPigeon\n",
    "\n",
    "PAVICS offers a number of subsetting processes:\n",
    " - subset_continents\n",
    " - subset_countries\n",
    " - subset_bbox\n",
    " - subset_wfs\n",
    " - subset\n",
    " \n",
    "The `subset_continents` and `subset_countries` use a predefined list of polygons for the subsetting. The `subset_bbox` takes the geographical coordinates of the two opposite corner of a rectangle to define the subset region, while both `subset_wfs` and `subset` use a polygon defined on a remote geoserver, identified by a typename and a feature id. The only difference is that `subset` also does temporal subsetting. \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "afr = fp.subset_continents(resource=thredds+res, region='Africa')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "ename": "XMLSyntaxError",
     "evalue": "Opening and ending tag mismatch: hr line 5 and body, line 6, column 8 (<string>, line 6)",
     "output_type": "error",
     "traceback": [
      "Traceback \u001b[0;36m(most recent call last)\u001b[0m:\n",
      "  File \u001b[1;32m\"/home/david/.conda/envs/birdy/lib/python3.6/site-packages/IPython/core/interactiveshell.py\"\u001b[0m, line \u001b[1;32m2963\u001b[0m, in \u001b[1;35mrun_code\u001b[0m\n    exec(code_obj, self.user_global_ns, self.user_ns)\n",
      "  File \u001b[1;32m\"<ipython-input-26-ba96f4e0b0a3>\"\u001b[0m, line \u001b[1;32m1\u001b[0m, in \u001b[1;35m<module>\u001b[0m\n    mex = fp.subset_countries(resource=thredds+res, region='FRA')\n",
      "  File \u001b[1;32m\"</home/david/src/birdy/birdy/client/base.py-7>\"\u001b[0m, line \u001b[1;32m25\u001b[0m, in \u001b[1;35msubset_countries\u001b[0m\n",
      "  File \u001b[1;32m\"/home/david/src/birdy/birdy/client/base.py\"\u001b[0m, line \u001b[1;32m206\u001b[0m, in \u001b[1;35m_execute\u001b[0m\n    ]\n",
      "  File \u001b[1;32m\"/home/david/src/OWSLib/owslib/wps.py\"\u001b[0m, line \u001b[1;32m328\u001b[0m, in \u001b[1;35mexecute\u001b[0m\n    requestElement = execution.buildRequest(identifier, inputs, output, mode=mode, lineage=lineage)\n",
      "  File \u001b[1;32m\"/home/david/src/OWSLib/owslib/wps.py\"\u001b[0m, line \u001b[1;32m856\u001b[0m, in \u001b[1;35msubmitRequest\u001b[0m\n",
      "  File \u001b[1;32m\"/home/david/src/OWSLib/owslib/wps.py\"\u001b[0m, line \u001b[1;32m553\u001b[0m, in \u001b[1;35mreadFromUrl\u001b[0m\n    def readFromUrl(self, url, data={}, method='Get', username=None, password=None,\n",
      "  File \u001b[1;32m\"/home/david/src/OWSLib/owslib/wps.py\"\u001b[0m, line \u001b[1;32m466\u001b[0m, in \u001b[1;35m_readFromUrl\u001b[0m\n    1], method='Get', username=username, password=password,\n",
      "  File \u001b[1;32m\"src/lxml/etree.pyx\"\u001b[0m, line \u001b[1;32m3213\u001b[0m, in \u001b[1;35mlxml.etree.fromstring\u001b[0m\n",
      "  File \u001b[1;32m\"src/lxml/parser.pxi\"\u001b[0m, line \u001b[1;32m1876\u001b[0m, in \u001b[1;35mlxml.etree._parseMemoryDocument\u001b[0m\n",
      "  File \u001b[1;32m\"src/lxml/parser.pxi\"\u001b[0m, line \u001b[1;32m1764\u001b[0m, in \u001b[1;35mlxml.etree._parseDoc\u001b[0m\n",
      "  File \u001b[1;32m\"src/lxml/parser.pxi\"\u001b[0m, line \u001b[1;32m1126\u001b[0m, in \u001b[1;35mlxml.etree._BaseParser._parseDoc\u001b[0m\n",
      "  File \u001b[1;32m\"src/lxml/parser.pxi\"\u001b[0m, line \u001b[1;32m600\u001b[0m, in \u001b[1;35mlxml.etree._ParserContext._handleParseResultDoc\u001b[0m\n",
      "  File \u001b[1;32m\"src/lxml/parser.pxi\"\u001b[0m, line \u001b[1;32m710\u001b[0m, in \u001b[1;35mlxml.etree._handleParseResult\u001b[0m\n",
      "\u001b[0;36m  File \u001b[0;32m\"src/lxml/parser.pxi\"\u001b[0;36m, line \u001b[0;32m639\u001b[0;36m, in \u001b[0;35mlxml.etree._raiseParseError\u001b[0;36m\u001b[0m\n",
      "\u001b[0;36m  File \u001b[0;32m\"<string>\"\u001b[0;36m, line \u001b[0;32m6\u001b[0m\n\u001b[0;31mXMLSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m Opening and ending tag mismatch: hr line 5 and body, line 6, column 8\n"
     ]
    }
   ],
   "source": [
    "mex = fp.subset_countries(resource=thredds+res, region='FRA')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'mex' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-21-ea3df3f0751a>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mmex\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'mex' is not defined"
     ]
    }
   ],
   "source": [
    "mex.get()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " owslib.wps.WPSException : {'code': 'NoApplicableCode', 'locator': None, 'text': 'Process error: wps_subset_bbox.py._handler Line 87 Traceback (most recent call last):\\n  File \"/opt/birdhouse/src/flyingpigeon/flyingpigeon/processes/wps_subset_bbox.py\", line 84, in _handler\\n    spatial_mode=\\'bbox\\')\\n  File \"/opt/birdhouse/src/flyingpigeon/flyingpigeon/handler_common.py\", line 46, in wfs_common\\n    raise Exception(traceback.format_exc())\\nException: Traceback (most recent call last):\\n  File \"/opt/birdhouse/src/flyingpigeon/flyingpigeon/handler_common.py\", line 44, in wfs_common\\n    output_path=\\'/tmp\\')\\n  File \"/opt/birdhouse/src/flyingpigeon/flyingpigeon/utils.py\", line 1230, in opendap_or_download\\n    raise IOError(\"This does not appear to be a valid NetCDF file.\")\\nIOError: This does not appear to be a valid NetCDF file.\\n\\n'}\n"
     ]
    }
   ],
   "source": [
    "import datetime as dt\n",
    "bb = fp.subset_bbox(resource=thredds+res, \n",
    "                    lon0=10, lon1=20, lat0=40, lat1=50, \n",
    "                    initial_datetime=dt.datetime(2006, 1, 1),\n",
    "                    final_datetime=dt.datetime(2006, 6, 1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "fp.subset_wfs(resource=thredds+res, \n",
    "             typename=)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "fn = thredds+res"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "f = \"https://pavics.ouranos.ca/twitcher/ows/proxy/thredds/fileServer/birdhouse/testdata/flyingpigeon/cmip5/tasmax_Amon_MPI-ESM-MR_rcp45_r2i1p1_200601-200612.nc\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests\n",
    "r = requests.get(fn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "b'\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\\r\\n  <head>\\r\\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\\r\\n    <title>TDS - Error report</title>\\r\\n    <link rel=\"stylesheet\" href=\"/thredds/tds.css\" type=\"text/css\"/>\\r\\n  </head>\\r\\n  <body>\\r\\n    <h1>HTTP Status 404 - Not Found</h1>\\r\\n    <HR size=\"1\" noshade=\"noshade\">\\r\\n    <p><b>Status</b> 404 - Not Found</p>\\r\\n    <HR size=\"1\" noshade=\"noshade\">\\r\\n    <h3>THREDDS Data Server Version 4.6\\r\\n      -- <a href=\\'http://www.unidata.ucar.edu/software/thredds/v4.6/tds/TDS.html\\'>Documentation</a></h3>\\r\\n  </body>\\r\\n</html>\\r\\n'"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "r.content"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
