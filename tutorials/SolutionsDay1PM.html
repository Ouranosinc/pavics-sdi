

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Exercises &mdash; PAVICS 0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PAVICS 0.1 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PAVICS
          

          
            
            <img src="../_static/pavics_v.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/index.html">Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processes/index.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/index.html">Using Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/index.html">Graphical User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../provenance/index.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">TODO</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PAVICS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Exercises</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/SolutionsDay1PM.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Exercises">
<h1>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Ideas">
<h2>Ideas<a class="headerlink" href="#Ideas" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Use PAVICS WPS to to take a yearly average of a netcdf file<ul>
<li>Use the Hummingbird WPS suite : hint use the ‘cdo_operation’
process to run ‘yearmean’</li>
<li>Use this OpenDap link to a CanESM monthly tas .nc file :
‘<a class="reference external" href="http://boreas.ouranos.ca:8083/thredds/dodsC/birdhouse/CCCMA/CanESM2/historical/mon/atmos/r1i1p1/tas/tas_Amon_CanESM2_historical_r1i1p1_185001-200512.nc">http://boreas.ouranos.ca:8083/thredds/dodsC/birdhouse/CCCMA/CanESM2/historical/mon/atmos/r1i1p1/tas/tas_Amon_CanESM2_historical_r1i1p1_185001-200512.nc</a>’</li>
<li>PAVICS wps url :
‘<a class="reference external" href="https://boreas.ouranos.ca/twitcher/ows/proxy/hummingbord/wps">https://boreas.ouranos.ca/twitcher/ows/proxy/hummingbord/wps</a>’</li>
<li>the NCDUMP example can help structure your code!</li>
</ul>
</li>
<li>Access point information from a layer (lat, lon of your choice for
the layer of your choice). There are two ways to do this, one is to
use a Web Coverage Service to access the gridded data, the other is
to use the GetFeatureInfo operation of Web Mapping Service (see
<a class="reference external" href="http://cite.opengeospatial.org/pub/cite/files/edu/wms/text/operations.html#getfeatureinfo">http://cite.opengeospatial.org/pub/cite/files/edu/wms/text/operations.html#getfeatureinfo</a>).
The challenge with GeoMet’s WCS services is that it tends to be
fragile (not all layers seem to work all the time). For WMS, the
service appears robust, but the challenge is rather to map the
geographic coordinates of the point of interest (lat, lon) into
native geodesic coordinates (x,y).<ul>
<li>Possible datasources:<ul>
<li>ECCC GeoMet WCS :
‘<a class="reference external" href="http://geo.weather.gc.ca/geomet/?lang=en&amp;service=WCS">http://geo.weather.gc.ca/geomet/?lang=en&amp;service=WCS</a>’</li>
<li>ECCC GeoMet WMS :
‘<a class="reference external" href="http://geo.weather.gc.ca/geomet/?lang=en&amp;service=WMS">http://geo.weather.gc.ca/geomet/?lang=en&amp;service=WMS</a>’</li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="WPS-Exercise-:-solution">
<h2>WPS Exercise : solution<a class="headerlink" href="#WPS-Exercise-:-solution" title="Permalink to this headline">¶</a></h2>
<p>Run PAVICS ‘getpoint’ wps to extract data from a single grid cell</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [160]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">owslib.wps</span> <span class="k">import</span> <span class="n">WebProcessingService</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="k">import</span> <span class="n">etree</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="k">import</span> <span class="n">Dataset</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">parseStatus</span><span class="p">(</span><span class="n">execute</span><span class="p">):</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">execute</span><span class="o">.</span><span class="n">statusLocation</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;{http://www.w3.org/1999/xlink}href&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [161]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://boreas.ouranos.ca/twitcher/ows/proxy/hummingbird/wps&#39;</span>
<span class="n">wps</span> <span class="o">=</span> <span class="n">WebProcessingService</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [162]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get metadata about the process</span>
<span class="n">proc_name</span> <span class="o">=</span> <span class="s1">&#39;cdo_operation&#39;</span>
<span class="n">process</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">describeprocess</span><span class="p">(</span><span class="n">proc_name</span><span class="p">)</span> <span class="c1"># get process info</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">process</span><span class="o">.</span><span class="n">dataInputs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inputs :&#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="s1">&#39; : &#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">abstract</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">process</span><span class="o">.</span><span class="n">processOutputs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;outputs :&#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="s1">&#39; : &#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">abstract</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
inputs : dataset  :  You may provide a URL or upload a NetCDF file.
inputs : dataset_opendap  :  Or provide a remote OpenDAP data URL, for example: http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/ncep.reanalysis2.dailyavgs/surface/mslp.2016.nc
inputs : operator  :  Choose a CDO Operator.                          See the CDO documentation to lookup a description of the operators.
outputs : output  :  NetCDF Output generated by CDO.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [163]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nc_url</span> <span class="o">=</span> <span class="s1">&#39;http://boreas.ouranos.ca:8083/thredds/dodsC/birdhouse/CCCMA/CanESM2/historical/mon/atmos/r1i1p1/tas/tas_Amon_CanESM2_historical_r1i1p1_185001-200512.nc&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nc_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
http://boreas.ouranos.ca:8083/thredds/dodsC/birdhouse/CCCMA/CanESM2/historical/mon/atmos/r1i1p1/tas/tas_Amon_CanESM2_historical_r1i1p1_185001-200512.nc
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [164]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">myinputs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">myinputs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;dataset_opendap&#39;</span><span class="p">,</span><span class="n">nc_url</span><span class="p">))</span>
<span class="n">myinputs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;operator&#39;</span><span class="p">,</span><span class="s1">&#39;yearmean&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myinputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;dataset_opendap&#39;, &#39;http://boreas.ouranos.ca:8083/thredds/dodsC/birdhouse/CCCMA/CanESM2/historical/mon/atmos/r1i1p1/tas/tas_Amon_CanESM2_historical_r1i1p1_185001-200512.nc&#39;), (&#39;operator&#39;, &#39;yearmean&#39;)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [165]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">proc_name</span><span class="p">)</span>
<span class="n">execute</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">proc_name</span><span class="p">,</span> <span class="n">myinputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
cdo_operation
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [166]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">parseStatus</span><span class="p">(</span><span class="n">execute</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
https://pavics.ouranos.ca:443/wpsoutputs/hummingbird/749ec268-bba3-11e8-8b91-0242ac12000d/cdo_yearmean_VcLf76.nc
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [167]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r</span><span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
<span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;./output/&#39;</span> <span class="o">+</span><span class="n">ref</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
./output/cdo_yearmean_VcLf76.nc
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [168]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nc1</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">nc1</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">][:]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">nc1</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">nc1</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">tasmax</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_SolutionsDay1PM_10_0.png" src="../_images/tutorials_SolutionsDay1PM_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [169]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tas</span><span class="p">[:,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_SolutionsDay1PM_11_0.png" src="../_images/tutorials_SolutionsDay1PM_11_0.png" />
</div>
</div>
</div>
<div class="section" id="WCS-Example">
<h2>WCS Example<a class="headerlink" href="#WCS-Example" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [170]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">owslib.wcs</span> <span class="k">import</span> <span class="n">WebCoverageService</span>
<span class="n">geomet_wcs_url</span> <span class="o">=</span> <span class="s1">&#39;http://geo.weather.gc.ca/geomet/?lang=en&amp;service=WCS&#39;</span>
<span class="n">pavics_wcs_url</span> <span class="o">=</span> <span class="s1">&#39;http://boreas.ouranos.ca:8087/geoserver/wcs&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [179]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">crs</span><span class="o">=</span><span class="s1">&#39;epsg:4326&#39;</span>
<span class="n">w</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">wcs</span> <span class="o">=</span> <span class="n">WebCoverageService</span><span class="p">(</span><span class="s1">&#39;http://geo.weather.gc.ca/geomet?SERVICE=WCS&amp;VERSION=1.0.0&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">getCoverage</span><span class="p">(</span><span class="s1">&#39;RDPA.24F_PR&#39;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;image/tiff&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">145</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">145</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [180]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fn</span> <span class="o">=</span> <span class="s1">&#39;rdpa.24f_pr.tiff&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [183]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[[  0   0   0 255]]]
</pre></div></div>
</div>
</div>
<div class="section" id="WMS-Example">
<h2>WMS Example<a class="headerlink" href="#WMS-Example" title="Permalink to this headline">¶</a></h2>
<p>Here the challenge is to make the correspondance between geographic
coordinates and the layer’s geodesic coordinates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [185]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">owslib.wms</span> <span class="k">import</span> <span class="n">WebMapService</span>
<span class="n">geomet_wms_url</span> <span class="o">=</span><span class="s1">&#39;http://geo.weather.gc.ca/geomet/?lang=en&amp;service=WMS&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [188]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wms</span> <span class="o">=</span> <span class="n">WebMapService</span><span class="p">(</span><span class="n">geomet_wms_url</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.3.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [192]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">layer</span> <span class="o">=</span> <span class="s1">&#39;RDPA.24F_PR&#39;</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">wms</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [206]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">resp</span> <span class="o">=</span> <span class="n">wms</span><span class="o">.</span><span class="n">getfeatureinfo</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">layer</span><span class="p">,],</span> <span class="n">srs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">146</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="o">-</span><span class="mi">144</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;image/png&#39;</span><span class="p">,</span>  <span class="n">query_layers</span><span class="o">=</span><span class="p">[</span><span class="n">layer</span><span class="p">,],</span> <span class="n">info_format</span><span class="o">=</span><span class="s1">&#39;application/vnd.ogc.gml&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [209]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;

&lt;msGMLOutput
         xmlns:gml=&#34;http://www.opengis.net/gml&#34;
         xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;
         xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;&gt;
        &lt;RDPA.24F_PR_layer&gt;
        &lt;gml:name&gt;RDPA.24F - Quantity of precipitation&lt;/gml:name&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-149.641318,45.444035 -149.641318,45.444035&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-149.64132&lt;/x&gt;
                        &lt;y&gt;45.444035&lt;/y&gt;
                        &lt;value_0&gt;0.51100004&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.51100004,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-149.549319,45.495530 -149.549319,45.495530&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-149.54932&lt;/x&gt;
                        &lt;y&gt;45.49553&lt;/y&gt;
                        &lt;value_0&gt;0.32050002&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.32050002,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-149.457084,45.546940 -149.457084,45.546940&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-149.45708&lt;/x&gt;
                        &lt;y&gt;45.54694&lt;/y&gt;
                        &lt;value_0&gt;0.24400002&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.24400002,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-149.364613,45.598265 -149.364613,45.598265&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-149.36461&lt;/x&gt;
                        &lt;y&gt;45.598265&lt;/y&gt;
                        &lt;value_0&gt;0.23650001&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.23650001,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-149.271905,45.649504 -149.271905,45.649504&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-149.2719&lt;/x&gt;
                        &lt;y&gt;45.649504&lt;/y&gt;
                        &lt;value_0&gt;0.29000002&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.29000002,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-149.178959,45.700656 -149.178959,45.700656&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-149.17896&lt;/x&gt;
                        &lt;y&gt;45.700656&lt;/y&gt;
                        &lt;value_0&gt;0.38150001&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.38150001,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-149.085776,45.751721 -149.085776,45.751721&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-149.08578&lt;/x&gt;
                        &lt;y&gt;45.751721&lt;/y&gt;
                        &lt;value_0&gt;0.49600002&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.49600002,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.992354,45.802699 -148.992354,45.802699&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.99235&lt;/x&gt;
                        &lt;y&gt;45.802699&lt;/y&gt;
                        &lt;value_0&gt;0.59500003&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.59500003,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.898694,45.853588 -148.898694,45.853588&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.89869&lt;/x&gt;
                        &lt;y&gt;45.853588&lt;/y&gt;
                        &lt;value_0&gt;0.65600002&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.65600002,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.804795,45.904389 -148.804795,45.904389&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.8048&lt;/x&gt;
                        &lt;y&gt;45.904389&lt;/y&gt;
                        &lt;value_0&gt;0.64100003&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.64100003,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.710657,45.955101 -148.710657,45.955101&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.71066&lt;/x&gt;
                        &lt;y&gt;45.955101&lt;/y&gt;
                        &lt;value_0&gt;0.60250002&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.60250002,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.616279,46.005724 -148.616279,46.005724&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.61628&lt;/x&gt;
                        &lt;y&gt;46.005724&lt;/y&gt;
                        &lt;value_0&gt;0.72500002&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;0.72500002,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.521660,46.056255 -148.521660,46.056255&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.52166&lt;/x&gt;
                        &lt;y&gt;46.056255&lt;/y&gt;
                        &lt;value_0&gt;1.0225&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;1.0225,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.426801,46.106697 -148.426801,46.106697&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.4268&lt;/x&gt;
                        &lt;y&gt;46.106697&lt;/y&gt;
                        &lt;value_0&gt;1.3505001&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;1.3505001,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.331701,46.157047 -148.331701,46.157047&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.3317&lt;/x&gt;
                        &lt;y&gt;46.157047&lt;/y&gt;
                        &lt;value_0&gt;1.6785001&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;1.6785001,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.236360,46.207305 -148.236360,46.207305&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.23636&lt;/x&gt;
                        &lt;y&gt;46.207305&lt;/y&gt;
                        &lt;value_0&gt;1.9455001&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;1.9455001,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.140777,46.257470 -148.140777,46.257470&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.14078&lt;/x&gt;
                        &lt;y&gt;46.25747&lt;/y&gt;
                        &lt;value_0&gt;2.0525&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;2.0525,0&lt;/value_list&gt;
                        &lt;class&gt;2.0 - 5.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-148.044951,46.307543 -148.044951,46.307543&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-148.04495&lt;/x&gt;
                        &lt;y&gt;46.307543&lt;/y&gt;
                        &lt;value_0&gt;1.9225001&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;1.9225001,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-147.948884,46.357522 -147.948884,46.357522&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-147.94888&lt;/x&gt;
                        &lt;y&gt;46.357522&lt;/y&gt;
                        &lt;value_0&gt;1.5870001&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;1.5870001,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
                &lt;RDPA.24F_PR_feature&gt;
                        &lt;gml:boundedBy&gt;
                                &lt;gml:Box srsName=&#34;EPSG:4326&#34;&gt;
                                        &lt;gml:coordinates&gt;-147.852573,46.407408 -147.852573,46.407408&lt;/gml:coordinates&gt;
                                &lt;/gml:Box&gt;
                        &lt;/gml:boundedBy&gt;
                        &lt;x&gt;-147.85257&lt;/x&gt;
                        &lt;y&gt;46.407408&lt;/y&gt;
                        &lt;value_0&gt;1.1595&lt;/value_0&gt;
                        &lt;value_1&gt;0&lt;/value_1&gt;
                        &lt;value_list&gt;1.1595,0&lt;/value_list&gt;
                        &lt;class&gt;0.1 - 2.0&lt;/class&gt;
                        &lt;red&gt;-1&lt;/red&gt;
                        &lt;green&gt;-1&lt;/green&gt;
                        &lt;blue&gt;-1&lt;/blue&gt;
                &lt;/RDPA.24F_PR_feature&gt;
        &lt;/RDPA.24F_PR_layer&gt;
&lt;/msGMLOutput&gt;

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [199]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">resp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[199]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>b&#39;&lt;?xml version=\&#39;1.0\&#39; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;\n&lt;ServiceExceptionReport version=&quot;1.3.0&quot; xmlns=&quot;http://www.opengis.net/ogc&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.opengis.net/ogc http://schemas.opengis.net/wms/1.3.0/exceptions_1_3_0.xsd&quot;&gt;\n&lt;ServiceException code=&quot;LayerNotDefined&quot;&gt;\nmsWMSLoadGetMapParams(): WMS server error. Invalid layer(s) given in the LAYERS parameter. A layer might be disabled for this request. Check wms/ows_enable_request settings.\n&lt;/ServiceException&gt;\n&lt;/ServiceExceptionReport&gt;\n&#39;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">layer</span> <span class="o">=</span> <span class="s1">&#39;Synthese2015:TempAnnObs&#39;</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [123]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">resp</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">getCoverage</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">boundingBoxWGS84</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">supportedCRS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">79</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;GeoTiff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [124]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">resp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[124]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>b&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;ServiceExceptionReport version=&quot;1.2.0&quot; &gt;   &lt;ServiceException&gt;\n      java.lang.NullPointerException\n&lt;/ServiceException&gt;&lt;/ServiceExceptionReport&gt;&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="WFS-exercise">
<h1>WFS exercise<a class="headerlink" href="#WFS-exercise" title="Permalink to this headline">¶</a></h1>
<p>I still can’t find a way to extract the XML into a meaningful object…</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [133]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">owslib.wfs</span> <span class="k">import</span> <span class="n">WebFeatureService</span>
<span class="n">pavics_wfs_url</span> <span class="o">=</span> <span class="s1">&#39;http://boreas.ouranos.ca:8087/geoserver/wfs&#39;</span>
<span class="n">wfs</span> <span class="o">=</span> <span class="n">WebFeatureService</span><span class="p">(</span><span class="n">pavics_wfs_url</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.1.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [134]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">wfs</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="s1">&#39;scratchTJS:canada_admin_boundaries&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [190]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">feat</span> <span class="o">=</span> <span class="n">wfs</span><span class="o">.</span><span class="n">getfeature</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [150]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span class="n">ogr</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [194]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="s1">&#39;WFS&#39;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [195]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">source</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [184]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">source</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [188]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">txt</span><span class="p">[:</span><span class="mi">1900</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[188]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;wfs:FeatureCollection xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:TravisTest=&quot;http://boreas.ouranos.ca:8087/geoserver/TravisTest&quot; xmlns:wfs=&quot;http://www.opengis.net/wfs&quot; xmlns:gml=&quot;http://www.opengis.net/gml&quot; xmlns:ogc=&quot;http://www.opengis.net/ogc&quot; xmlns:ows=&quot;http://www.opengis.net/ows&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; xmlns:scratchTJS=&quot;http://boreas.ouranos.ca:8087/scratchtjs&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; numberOfFeatures=&quot;13&quot; timeStamp=&quot;2018-09-18T17:22:25.259Z&quot; xsi:schemaLocation=&quot;http://boreas.ouranos.ca:8087/scratchtjs http://boreas.ouranos.ca:8087/geoserver/wfs?service=WFS&amp;amp;version=1.1.0&amp;amp;request=DescribeFeatureType&amp;amp;typeName=scratchTJS%3Acanada_admin_boundaries http://www.opengis.net/wfs http://boreas.ouranos.ca:8087/geoserver/schemas/wfs/1.1.0/wfs.xsd&quot;&gt;&lt;gml:boundedBy&gt;&lt;gml:Envelope srsDimension=&quot;2&quot; srsName=&quot;GCS_WGS_1984&quot;&gt;&lt;gml:lowerCorner&gt;-141.01807315799994 41.681435425000075&lt;/gml:lowerCorner&gt;&lt;gml:upperCorner&gt;-52.61940850399992 83.13550252400006&lt;/gml:upperCorner&gt;&lt;/gml:Envelope&gt;&lt;/gml:boundedBy&gt;&lt;gml:featureMembers&gt;&lt;scratchTJS:canada_admin_boundaries gml:id=&quot;canada_admin_boundaries.1&quot;&gt;&lt;gml:boundedBy&gt;&lt;gml:Envelope srsName=&quot;GCS_WGS_1984&quot; srsDimension=&quot;2&quot;&gt;&lt;gml:lowerCorner&gt;-139.0522 48.3089&lt;/gml:lowerCorner&gt;&lt;gml:upperCorner&gt;-114.0542 60.0001&lt;/gml:upperCorner&gt;&lt;/gml:Envelope&gt;&lt;/gml:boundedBy&gt;&lt;scratchTJS:the_geom&gt;&lt;gml:MultiSurface srsName=&quot;GCS_WGS_1984&quot; srsDimension=&quot;2&quot;&gt;&lt;gml:surfaceMember&gt;&lt;gml:Polygon&gt;&lt;gml:exterior&gt;&lt;gml:LinearRing&gt;&lt;gml:posList&gt;-123.5398 48.3173 -123.5397 48.3172 -123.5393 48.3172 -123.5388 48.3171 -123.538 48.3173 -123.5378 48.3174 -123.5374 48.3174 -123.5373 48.3172 -123.5374 48.3167 -123.5386 48.3166 -123.5386 48.3165 -123.5382 48.3165 -123.5381 48.3164 -123.5386 48.3162 -123.5389 48.3159 -123.5401 48.3159 -123.5405 48.3158 -123.5407 48.3156 -123.5406 48.3152 -123.540&#39;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wcs</span> <span class="o">=</span> <span class="n">WebCoverageService</span><span class="p">(</span><span class="n">geomet_wcs_url</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">layer_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RDPS.ETA_PR&#39;</span><span class="p">,]</span> <span class="c1"># &#39;REPS.DIAG.3_PRMM.ERMEAN&#39;</span>
<span class="n">lid</span> <span class="o">=</span> <span class="n">layer_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">lid</span><span class="p">]</span>
<span class="n">meta</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[55]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;RDPS.ETA - Precipitation accumulation&#39;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">desc</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">wcs</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;PR&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">supportedFormats</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">desc</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">desc</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[73]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>dict_keys([&#39;HRDPA.6F_PR&#39;, &#39;HRDPA.6P_PR&#39;, &#39;HRDPA.24F_PR&#39;, &#39;HRDPA.24P_PR&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.50&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.100&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.225&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.250&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.300&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.350&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.450&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.500&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.600&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.700&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.750&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.800&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.900&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.970&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.985&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.1000&#39;, &#39;HRDPS.CONTINENTAL.PRES_ES.1015&#39;, &#39;HRDPS.CONTINENTAL.PRES_GZ.100&#39;, &#39;HRDPS.CONTINENTAL.PRES_GZ.200&#39;, &#39;HRDPS.CONTINENTAL.PRES_GZ.250&#39;, &#39;HRDPS.CONTINENTAL.PRES_GZ.700&#39;, &#39;HRDPS.CONTINENTAL.PRES_GZ.925&#39;, &#39;HRDPS.CONTINENTAL.PRES_GZ.1000&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.50&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.150&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.225&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.250&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.300&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.400&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.500&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.550&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.600&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.650&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.700&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.750&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.800&#39;, &#39;HRDPS.CONTINENTAL.PRES_HR.950&#39;])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [196]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">from</span> <span class="nn">owslib.wcs</span> <span class="k">import</span> <span class="n">WebCoverageService</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://deltaresdata.openearth.nl/geoserver/ows?&#39;</span>
<span class="n">wcs</span> <span class="o">=</span> <span class="n">WebCoverageService</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0.0&#39;</span><span class="p">)</span>
<span class="n">wcs</span><span class="o">.</span><span class="n">identification</span><span class="o">.</span><span class="n">type</span>
<span class="n">wcs</span><span class="o">.</span><span class="n">identification</span><span class="o">.</span><span class="n">title</span>
<span class="nb">list</span><span class="p">(</span><span class="n">wcs</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[196]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;DANK:DANK:D15a1-Waterbergend_vermogen_Regionale wateren&#39;,
 &#39;DANK:DANK-005c - Gewasverdampingsreductie&#39;,
 &#39;DANK:DANK-008a_verzilting_grondwater&#39;,
 &#39;DANK:DANK-022_Delftstofwinning_op_land_en_in_binnenwateren_rivier&#39;,
 &#39;DANK:DANK005a_irrigatiewater_kwelafname&#39;,
 &#39;DANK:DANK013_Waterzuivering_Waddenzee&#39;,
 &#39;DANK:DANK015_waterberging_grondwater&#39;,
 &#39;DANK:DANK017_waterregulering_ondergrond&#39;,
 &#39;DANK:DANK024a_draagkracht_totale_zetting&#39;,
 &#39;DANK:DANK-006-Drinkwater&#39;,
 &#39;global:Globcover2009 V2.3&#39;,
 &#39;global:Sediment Thickness of the World&#39;,
 &#39;TestDank:sld_cookbook_raster&#39;,
 &#39;global:srtmplus15&#39;]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [197]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sed</span> <span class="o">=</span> <span class="n">wcs</span><span class="p">[</span><span class="s1">&#39;global:Sediment Thickness of the World&#39;</span><span class="p">]</span>
<span class="n">sed</span><span class="o">.</span><span class="n">keywords</span>
<span class="n">sed</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">highlimits</span>
<span class="n">sed</span><span class="o">.</span><span class="n">boundingboxes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[197]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[{&#39;bbox&#39;: (-180.04167, -90.04167, 180.04167, 90.04167),
  &#39;nativeSrs&#39;: &#39;EPSG:4326&#39;}]
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [214]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">requestbbox</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">7.283406057098745</span><span class="p">,</span> <span class="mf">35.59251369598765</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.266739197530853</span><span class="p">,</span> <span class="mf">37.6050139853395</span><span class="p">)</span>
<span class="n">requestwidth</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">requestheight</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">getCoverage</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="n">sed</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                                  <span class="n">bbox</span><span class="o">=</span><span class="n">requestbbox</span><span class="p">,</span>
                                  <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;GeoTIFF&#39;</span><span class="p">,</span>
                                  <span class="n">crs</span><span class="o">=</span><span class="n">sed</span><span class="o">.</span><span class="n">boundingboxes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;nativeSrs&#39;</span><span class="p">],</span>
                                  <span class="n">width</span><span class="o">=</span><span class="n">requestwidth</span><span class="p">,</span>
                                  <span class="n">height</span><span class="o">=</span><span class="n">requestheight</span><span class="p">)</span>
<span class="c1"># random unique filename</span>
<span class="n">tmpdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span><span class="s1">&#39;test.tif&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [215]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span class="n">gdal</span><span class="p">,</span> <span class="n">osr</span>

<span class="n">gdal</span><span class="o">.</span><span class="n">UseExceptions</span><span class="p">()</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">fn</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetGeoTransform</span><span class="p">()</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetProjection</span><span class="p">()</span>

<span class="n">inproj</span> <span class="o">=</span> <span class="n">osr</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">()</span>
<span class="n">inproj</span><span class="o">.</span><span class="n">ImportFromWkt</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">inproj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GEOGCS[&#34;WGS 84&#34;,
    DATUM[&#34;WGS_1984&#34;,
        SPHEROID[&#34;WGS 84&#34;,6378137,298.257223563,
            AUTHORITY[&#34;EPSG&#34;,&#34;7030&#34;]],
        AUTHORITY[&#34;EPSG&#34;,&#34;6326&#34;]],
    PRIMEM[&#34;Greenwich&#34;,0],
    UNIT[&#34;degree&#34;,0.0174532925199433],
    AUTHORITY[&#34;EPSG&#34;,&#34;4326&#34;]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [216]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="n">subplot_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">gt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds</span><span class="o">.</span><span class="n">RasterXSize</span> <span class="o">*</span> <span class="n">gt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
          <span class="n">gt</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds</span><span class="o">.</span><span class="n">RasterYSize</span> <span class="o">*</span> <span class="n">gt</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">gt</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:],</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_SolutionsDay1PM_47_0.png" src="../_images/tutorials_SolutionsDay1PM_47_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [204]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.io</span> <span class="k">import</span> <span class="n">shapereader</span>

<span class="c1"># set up a map with coastlines around Auckland:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">platecarree</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">globe</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Globe</span><span class="p">(</span><span class="n">datum</span><span class="o">=</span><span class="s1">&#39;WGS84&#39;</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">platecarree</span><span class="p">)</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mf">174.25</span><span class="p">,</span> <span class="mf">175.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.5</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="c1">#ax.coastlines(&#39;10m&#39;,color=&#39;red&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;string&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">unknown</span>
<span class="ansi-red-fg">ParseError</span><span class="ansi-red-fg">:</span> not well-formed (invalid token): line 60, column 20

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [206]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[206]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(3, 4)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Ouranos &amp; CRIM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>