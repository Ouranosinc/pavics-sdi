

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Contributing &mdash; documentation PAVICS 0.1</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Recherche" href="../search.html"/>
    <link rel="top" title="documentation PAVICS 0.1" href="../index.html"/>
        <link rel="up" title="Developer Documentation" href="index.html"/>
        <link rel="next" title="System Architecture" href="../arch/index.html"/>
        <link rel="prev" title="Integration tests" href="integration_tests.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PAVICS
          

          
            
            <img src="../_static/pavics_v.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_balancing.html">Load balancing</a></li>
<li class="toctree-l2"><a class="reference internal" href="vm.html">VM configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="builddocs.html">Building the docs</a></li>
<li class="toctree-l2"><a class="reference internal" href="permissions.html">User management</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_management.html">Data management</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">Geoserver administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="integration_tests.html">Integration tests</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#benchmark-development-environment">Benchmark development environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-pycharm">Setting up pycharm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launching-individual-local-components">Launching individual local components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#public-thredds">Public THREDDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#https-thredds">HTTPS THREDDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#https-custom-wps-service">HTTPS CUSTOM WPS SERVICE</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processes/index.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/index.html">Using workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/index.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../provenance/index.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">TODO</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PAVICS</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Developer Documentation</a> &raquo;</li>
        
      <li>Contributing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/dev/contributing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="contributing">
<h1>Contributing<a class="headerlink" href="#contributing" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="benchmark-development-environment">
<h2>Benchmark development environment<a class="headerlink" href="#benchmark-development-environment" title="Lien permanent vers ce titre">¶</a></h2>
<p>Recommended VirtualBox installation:</p>
<ul class="simple">
<li>Install Oracle VM VirtualBox Extension Pack</li>
<li>Linux Ubuntu 16.04.3 (64-bit)</li>
<li>&gt;8 gb memory</li>
<li>&gt;70 gb disk space</li>
<li>&gt;2 CPUs</li>
<li>Network bridge access</li>
<li>Install VBoxGuestAdditions inside the Ubuntu guest for corresponding
VirtualBox version</li>
</ul>
<p>Required packages for various PAVICS components:</p>
<p>git docker.io docker-compose</p>
</div>
<div class="section" id="setting-up-pycharm">
<h2>Setting up pycharm<a class="headerlink" href="#setting-up-pycharm" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li>May need to uninstall wheel</li>
<li>For missing python modules: <a class="reference external" href="https://www.jetbrains.com/help/pycharm/installing-uninstalling-and-upgrading-packages.html">https://www.jetbrains.com/help/pycharm/installing-uninstalling-and-upgrading-packages.html</a></li>
</ul>
<p>Commands to run in Python console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pip</span>
<span class="n">pip</span><span class="o">.</span><span class="n">main</span><span class="p">([</span><span class="s1">&#39;install&#39;</span><span class="p">,</span> <span class="s1">&#39;https://github.com/geopython/pywps/archive/7cab3866e34ce24d3df56e3c1c546739b1cda2d7.zip&#39;</span><span class="p">])</span>
<span class="n">pip</span><span class="o">.</span><span class="n">main</span><span class="p">([</span><span class="s1">&#39;install&#39;</span><span class="p">,</span> <span class="s1">&#39;https://github.com/bird-house/OWSLib/archive/pingudev.zip&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="launching-individual-local-components">
<h2>Launching individual local components<a class="headerlink" href="#launching-individual-local-components" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="public-thredds">
<h3>Public THREDDS<a class="headerlink" href="#public-thredds" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Ouranosinc</span><span class="o">/</span><span class="n">PAVICS</span><span class="o">.</span><span class="n">git</span>
<span class="n">cp</span> <span class="n">PAVICS</span><span class="o">/</span><span class="n">birdhouse</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">public_thredds</span><span class="o">.</span><span class="n">yml</span> <span class="n">PAVICS</span><span class="o">/</span><span class="n">birdhouse</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>In this new docker-compose.override.yml change ${PATH_TO_LOCAL_NETCDF_FILES}
to an actual path on disk with NetCDF files.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">thredds</span>
</pre></div>
</div>
<p>Check that thredds is running at localhost:8083/thredds/</p>
</div>
<div class="section" id="https-thredds">
<h3>HTTPS THREDDS<a class="headerlink" href="#https-thredds" title="Lien permanent vers ce titre">¶</a></h3>
<p>First you will need a self-signed certificate:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">openssl</span> <span class="n">req</span> <span class="o">-</span><span class="n">x509</span> <span class="o">-</span><span class="n">nodes</span> <span class="o">-</span><span class="n">newkey</span> <span class="n">rsa</span><span class="p">:</span><span class="mi">4096</span> <span class="o">-</span><span class="n">keyout</span> <span class="n">key</span><span class="o">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">out</span> <span class="n">cert</span><span class="o">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">days</span> <span class="mi">365</span>
</pre></div>
</div>
<p>This will ask for various inputs that may be left blank.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">key</span><span class="o">.</span><span class="n">pem</span> <span class="o">&gt;&gt;</span> <span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
<p>cert.pm is your self-signed certificate.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Ouranosinc</span><span class="o">/</span><span class="n">PAVICS</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Switch to PAVICS/birdhouse directory.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">set_hostname</span><span class="o">.</span><span class="n">sh</span> <span class="n">dummy</span>
</pre></div>
</div>
<p>Add this dummy hostname to /etc/hosts</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span>       <span class="n">dummy</span><span class="o">.</span><span class="n">crim</span><span class="o">.</span><span class="n">ca</span>
</pre></div>
</div>
<p>Either set SSL_CERTIFICATE to the location of cert.pem and HOSTNAME to
dummy.crim.ca or use the template docker-compose_shorcut.sh and set those
values in it (here renamed to mycompose.sh).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">PAVICS</span><span class="o">/</span><span class="n">birdhouse</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">local_https_thredds</span><span class="o">.</span><span class="n">yml</span> <span class="n">PAVICS</span><span class="o">/</span><span class="n">birdhouse</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>In this override file specify the path to local netcdf files and set
localhost IP.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">mycompose</span><span class="o">.</span><span class="n">sh</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">thredds</span> <span class="n">proxy</span> <span class="n">magpie</span> <span class="n">twitcher</span>
</pre></div>
</div>
<p>It may take a minute for twitcher to get online. If it does not
respond after a while, try to restart everything once or twice.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">mycompose</span> <span class="n">down</span>
<span class="o">./</span><span class="n">mycompose</span><span class="o">.</span><span class="n">sh</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">thredds</span> <span class="n">proxy</span> <span class="n">magpie</span> <span class="n">twitcher</span>
</pre></div>
</div>
<p>Check that twitcher is running at <a class="reference external" href="https://localhost/twitcher/">https://localhost/twitcher/</a> (returns hello)</p>
<p>Check that magpie is running at <a class="reference external" href="https://localhost/magpie/">https://localhost/magpie/</a></p>
<p>Check that thredds is running at <a class="reference external" href="https://localhost/twitcher/ows/proxy/thredds/">https://localhost/twitcher/ows/proxy/thredds/</a></p>
<p>Play around with magpie permissions to check that the security is working</p>
</div>
<div class="section" id="https-custom-wps-service">
<h3>HTTPS CUSTOM WPS SERVICE<a class="headerlink" href="#https-custom-wps-service" title="Lien permanent vers ce titre">¶</a></h3>
<p>Follow all the steps of the HTTPS THREDDS setup above up to the
template copy, instead use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">PAVICS</span><span class="o">/</span><span class="n">birdhouse</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">local_https_wps</span><span class="o">.</span><span class="n">yml</span> <span class="n">PAVICS</span><span class="o">/</span><span class="n">birdhouse</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>In this override file, set the localhost IP, then you can switch the
wpsandbox image for the wps service image of your choice and assign it
an available port of your choice. Then assign a corresponding port to
the proxy. A new proxy configuration file need to be added to
PAVICS/birdhouse/config/proxy/conf.d/wpsandbox.conf for this service,
e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">server</span> <span class="p">{</span>
    <span class="n">listen</span> <span class="mi">8081</span><span class="p">;</span>
    <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
        <span class="n">proxy_pass</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">wpsandbox</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">mycompose</span><span class="o">.</span><span class="n">sh</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">proxy</span> <span class="n">magpie</span> <span class="n">twitcher</span> <span class="n">wpsandbox</span>
</pre></div>
</div>
<p>It may take a minute for twitcher to get online. If it does not
respond after a while, try to restart everything once or twice.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">mycompose</span> <span class="n">down</span>
<span class="o">./</span><span class="n">mycompose</span><span class="o">.</span><span class="n">sh</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">thredds</span> <span class="n">proxy</span> <span class="n">magpie</span> <span class="n">twitcher</span>
</pre></div>
</div>
<p>Check that twitcher is running at <a class="reference external" href="https://localhost/twitcher/">https://localhost/twitcher/</a> (returns hello)</p>
<p>Check that magpie is running at <a class="reference external" href="https://localhost/magpie/">https://localhost/magpie/</a></p>
<p>Register the new wps service in magpie: In Home &gt; Edit Services &gt;
wps &gt; Add Service. In our case the name is wpsandbox and the public
url is <a class="reference external" href="https://dummy.crim.ca/twitcher/ows/proxy/wpsandbox">https://dummy.crim.ca/twitcher/ows/proxy/wpsandbox</a> with the wps
service type. Then edit this new service Protected URL to
<a class="reference external" href="http://dummy.crim.ca:8081">http://dummy.crim.ca:8081</a></p>
<p>Alternatively, this can be entered in
PAVICS/birdhouse/config/magpie/providers.cfg</p>
<p>Check that the wps is running at <a class="reference external" href="https://localhost/twitcher/ows/proxy/wpsandbox/pywps?service=WPS&amp;version=1.0.0&amp;request=GetCapabilities">https://localhost/twitcher/ows/proxy/wpsandbox/pywps?service=WPS&amp;version=1.0.0&amp;request=GetCapabilities</a></p>
<p>Play around with magpie permissions to check that the security is working</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../arch/index.html" class="btn btn-neutral float-right" title="System Architecture" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="integration_tests.html" class="btn btn-neutral" title="Integration tests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Ouranos &amp; CRIM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>